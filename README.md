# Clashé«˜çº§ä½¿ç”¨parsersè‡ªå®šä¹‰ä»£ç†è§„åˆ™é˜²æ­¢è‡ªåŠ¨æ›´æ–°è®¢é˜…è¦†ç›–

>è‡ªä»Clashå®˜æ–¹åˆ åº“ä¹‹åï¼Œclashè¯¦ç»†æ‰‹å†Œå’Œæ–‡æ¡£è¶Šæ¥è¶Šå°‘ï¼Œå®˜ç½‘çš„æ‰‹å†Œä¹Ÿéšç€åˆ åº“è¢«åˆ é™¤äº†ã€‚è¿™å‡ å¤©æ•´ç†äº†ä¸€ä¸‹ç°å­˜çš„äº’è”ç½‘èµ„æ–™ï¼Œå†™äº†è¿™ç¯‡clashè¿›é˜¶æ•™ç¨‹è§£å†³â€œè‡ªåŠ¨æ›´æ–°è®¢é˜…ä¼šè¦†ç›–è‡ªå·±è®¾ç½®çš„rulesé—®é¢˜â€



## é—®é¢˜æè¿°

æ˜¨å¤©æˆ‘èŠ±äº†ä¸€ä¸‹åˆçš„æ—¶é—´ï¼Œè´¹åŠ²å¿ƒæ€å¥½ä¸å®¹æ˜“æ•´ç†å¥½äº†è‡ªå®šä¹‰çš„ä»£ç†ç­–ç•¥å’Œè§„åˆ™ï¼Œç»“æœä»Šå¤©å¼€æœºä¹‹åå‘ç°ï¼ŒæŸäº›é…ç½®å¥½çš„ç½‘ç«™åˆè®¿é—®ä¸äº†äº†ã€‚ç»è¿‡æ£€æŸ¥å‘ç°æ˜¯å› ä¸ºclashè‡ªåŠ¨æ›´æ–°è®¢é˜…çš„åŒæ—¶ï¼Œè¿˜ä¼šåŒæ—¶æ›´æ–°éšè®¢é˜…è¿æ¥é™„å¸¦çš„ä»£ç†è§„åˆ™æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ç›´æ¥æŠŠæˆ‘æ˜¨å¤©è‡ªå·±é…å¥½çš„è§„åˆ™è¦†ç›–äº†ï¼



## æœ€ç»ˆè§£å†³è®°å½•

ç»è¿‡æŸ¥æ‰¾èµ„æ–™ï¼Œå‘ç°ç½‘ä¸Šä¸»è¦æœ‰**ä¸¤ç§**ä¸ä¼šè¢«è‡ªåŠ¨æ›´æ–°è®¢é˜…è¦†ç›–çš„æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯

### ä¸€ã€é€šè¿‡mixinåŠŸèƒ½æ··å…¥

è¿™ä¸ªåŠŸèƒ½å®é™…ä¸Šå¯¹è§„åˆ™ï¼ˆrulesï¼‰çš„æ··å…¥ä¸å‹å¥½ï¼Œä½œè€…ä¹Ÿæ˜¯åœ¨å¾ˆæ–°çš„å‡ ä¸ªç‰ˆæœ¬æ‰æ”¯æŒå¯¹ä»£ç†è§„åˆ™çš„æ··å…¥ã€‚æ•…è¿™é‡Œä¸åšä»‹ç»ã€‚

ä¸æ¨èä½¿ç”¨mixinä½œä¸ºè‡ªå®šä¹‰ä»£ç†è§„åˆ™ä½¿ç”¨ï¼



### äºŒã€é€šè¿‡parseråœ¨æ¯æ¬¡æ›´æ–°è®¢é˜…æ—¶é¢„å¤„ç†é…ç½®æ–‡ä»¶

æ‰“å¼€clashè½¯ä»¶ï¼Œåœ¨è®¾ç½®æ‰¾åˆ°`Parsers` é€‰é¡¹ï¼š

![image-20231206155831513](./assets/image-20231206155831513.png)

æ‰“å¼€`Edit` æŒ‰é’®ï¼šæŒ‰ç…§ä¸‹å›¾ç¼–è¾‘ï¼ˆä»£ç è§ä¸‹æ–‡ï¼‰

![image-20231206155929342](./assets/image-20231206155929342.png)



è¿™æ®µä»£ç åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†çš„codeé€šè¿‡JavaScriptè¯­æ³•è§£æå­—ç¬¦ä¸²ï¼Œé€šè¿‡filteræ–¹æ³•ï¼Œå°†`ruletoDelete`å­—ç¬¦ä¸²ç›¸ç­‰çš„ä¸€ä¸ªæ¡ç›®å»é™¤ï¼Œç„¶åä¿ç•™å…¶ä½™éƒ¨åˆ†æ¡ç›®ã€‚

ç¬¬äºŒéƒ¨åˆ†`yaml`ä»£ç æ·»åŠ äº†ä¸€æ¡å‰ç½®é¢„åŠ rulesæ¡ç›®ã€‚



```json
parsers:
  - url: https://xxxxxxxxxxxxxxxxxxxx
    code: |
      module.exports.parse = async (raw, { axios, yaml, notify, console }, { name, url, interval, selected }) => {
        const obj = yaml.parse(raw)

        // åˆ é™¤ç‰¹å®šè§„åˆ™
        const ruleToDelete = "DOMAIN-SUFFIX,gov,ğŸ”°å›½å¤–æµé‡";
        obj.rules = obj.rules.filter(rule => rule !== ruleToDelete);

        // æ·»åŠ æ–°çš„ MATCH é¡¹
        //const newMatchRule = "DOMAIN-SUFFIX,gov,DIRECT";
        //obj.rules.push(newMatchRule);
        //æ³¨ï¼šè¿™é‡Œå®é™…ä¸Šæ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºåœ¨è¿™é‡Œæ·»åŠ çš„æ¡ç›®ä¼šè¢«æ”¾åˆ°rulesæ–‡ä»¶çš„æœ€æœ«å°¾ï¼Œå¯èƒ½è¢«å‰é¢çš„matchè¯æ¡å¹²æ‰°ï¼ï¼ï¼
		//æ­£ç¡®çš„æ–°åŠ æ¡ç›®ï¼Œåº”è¯¥å¦‚ä¸‹yamlæ®µæ‰€ç¤ºï¼Œä½¿ç”¨prepend-rulesè¯­æ³•æ·»åŠ ï¼
        return yaml.stringify(obj)
      }
    yaml:
      prepend-rules:
        - DOMAIN-SUFFIX,gov,DIRECT


```



# 2024-10-12æ›´æ–°

æœ€æ–°è‡ªç”¨parserè§„åˆ™ï¼š

```json
parsers:
  - url: https://xxxxxxxxxxxxxxxxxxx
    code: |
      module.exports.parse = async (raw, { axios, yaml, notify, console }, { name, url, interval, selected }) => {
        const obj = yaml.parse(raw)

        // åˆ é™¤ç‰¹å®šè§„åˆ™
        const ruleToDelete1 = "DOMAIN-SUFFIX,gov,ğŸ”°å›½å¤–æµé‡";
        obj.rules = obj.rules.filter(rule => rule !== ruleToDelete1);
        const ruleToDelete2 = "DOMAIN-SUFFIX,microsoft.com,DIRECT";
        obj.rules = obj.rules.filter(rule => rule !== ruleToDelete2);
        // æ·»åŠ æ–°çš„ MATCH é¡¹
        //const newMatchRule = "DOMAIN-SUFFIX,gov,DIRECT";
        //obj.rules.push(newMatchRule);
        
        return yaml.stringify(obj)
      }
    yaml:
      prepend-rules:
        - DOMAIN-SUFFIX,gov,DIRECT
        - DOMAIN-SUFFIX,csdn.net,DIRECT
        - DOMAIN-SUFFIX,microsoft.com,ğŸ”°å›½å¤–æµé‡
```







## ç‰¹åˆ«æ³¨æ„ï¼š

- yamlè¯­æ³•çš„**ç¼©è¿›æ˜¯ä¸¤ä¸ªç©ºæ ¼**ï¼Œä¸æ˜¯TABï¼ï¼å¦åˆ™ä¼šæŠ¥é”™
- é…ç½®å®Œæˆä¹‹åï¼Œéœ€è¦**é‡å¯clashå®¢æˆ·ç«¯**æ‰å¯ç”Ÿæ•ˆï¼ï¼ï¼



## å‚è€ƒèµ„æ–™

[1] https://chenjuefei.com:444/117.html

